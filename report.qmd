---
title: "Spatial Modeling of Cardiovascular Disease Associated with Increasing Airborne Particulate Matter"
format:
  arxiv-pdf:
    keep-tex: true  
    linenumbers: false
    doublespacing: false
    runninghead: "CVD Related to PM2.5"
  arxiv-html: default
author:
  - name: Johan Booc
    affiliations:
      - name: Texas A\&M University
        department: Department of Statistics
    email: jbooc24@tamu.edu
    
  - name: Christina Kim
    affiliations:
      - name: Texas A\&M University
        department: Department of Statistics
    email: christinaykim3@tamu.edu 

  - name: Shombit Roy
    affiliations:
      - name: Texas A\&M University
        department: Department of Statistics
    email: shombit123@tamu.edu
abstract: |
  Cardiovascular disease (CVD) is the leading cause of death in the United States. By using a spatial modeling technique (geographically weighted regression), we found the concentration of PM 2.5 is centered in the Strokebelt region. Policymakers and health practitioners can use these results to identify targeted interventions to curb the increasing rates of CVD, aiming to halt one of the world’s deadliest diseases.  
keywords: 
  - Fine Particulate Matter (PM2_5)
  - Cardiovascular Disease (CVD)
  - Cardiovascular Mortality (CVM)
bibliography: bibliography.bib  
---

# Introduction {#sec-intro}

-   Broad strokes: Explain how cardiovascular disease is the leading cause of death in the US, our paper filing the gap by putting the focus on the 18-44-year-old age group 

-   Specifics: Explicitly state how the CVD incidence rate varies spatially in the US, for our covariates. Our approach involves analyzing this relationship to produce risk prediction estimates for our specified age group. 

-   Central thesis: Despite past studies focusing on the Stroke Belt region of the United States, we aim to put our focus on the nationwide impact of PM 2.5 concentration, median household income, and unemployment rates on cardiovascular disease deaths, necessitating regional interventions. 

-   Step back: The overall outcome of our study involves aiding policymakers and health practitioners develop the necessary interventions in the targeted regions that are most affected by CVD.Related Works

Paragraph 1) Review of regression approaches in cardiovascular disease mortality 2) Review of geographically weighted regression models 3) GWR with CVD 4) Risk prediction Model 5) Direct comparison with clustering approaches

# Related Works

Paragraph 1. (Review of regression approaches in cardiovascular disease mortality) >>>> 
     There's been a growing popularity for the use of spatial models in the epidemiological domain to analyze the factors and spatial distribution 
     of a certain disease. The spatial models and techniques used differ between studies however the end goal remains the same, reduce the disease 
     mortality rates for the population. Statistical regression models have been a popular choice, specifically for CVD-related studies. The factors 
     that compromise the underlying causes for CVD can be seen as a dynamic and interconnected web. Zelko et. al examines the relationship 
     between CVD and covariates similar to our study, such as air pollution, social determinants, and county-level data. By using a GWR model,
     they found a correlation between household income, race, and healthcare access. Their results also showed that counties in the South had 
     the highest PM 2.5 concentrations. 

Paragraph 2. (Review of geographically weighted regression models) >>>>
     The geographically weighted regression model (GWR) stands out from the traditional regression models to explore spatial data by doing so
     on the local scale as well as taking into account varied coefficients for a certain spatial unit (Gebread et. al). The GWR model uses the 
     weighted least square method to estimate the regression coefficients. In general, we are interested in seeing values closer to the point of 
     interest than values farther from it, as they carry more weight and have a greater influence. The GWR model includes the parameter, neighborhood 
     (also known as the bandwidth). 

Paragraph 3. (Direct comparison with OLS approaches) >>>> 
     As seen in other studies, the Ordinary Least Squares model is a popular method for public health studies. Compared to the GWR model, 
     the OLS model generates the regression coefficients on a global scale. Because of this, the OLS method may not be the ideal choice. 
     as it is prone to hidden spatial variability. However, our paper takes into account the fact that socioeconomic factors are not 
     constant on a time and space basis with cardiovascular disease by using a GWR model, as it's a much more complex relationship. That's not
     to say the OLS model has no use in epidemiological research studies. One of the main goals of public health is to better the population as 
     a whole. The OLS model is efficient in capturing the average differences between covariates. To get to the root cause of CVD mortality rates,
     we need to start with the GRW model, to see overall improvement in the OLS model later on. 

Paragraph 4. (GWR with CVD) >>>> 
     The GWR model shows whether or not a linear relationship exists between cardiovascular disease deaths and the covariates, making it suitable 
     to see where the areas of focus should be placed in terms of improvement as well as an increase presence of healthcare practitioners. 
     The GWR model is better for analyzing disparities at the local-scale, see which socioeconomic factor affects different regions, and 
     then implement a policy for that specific region. Past studies tend to soley focus on the trends of socioeconomic covariates and its 
     spatial patterning. Our paper expands on past studies, by including the concentration of air pollutants as one of our covariates. By doing so,
     we are able to fully explore the dynamic relationship between geographical units and CVD incidence/mortality rates. 
     
Paragraph 5. (Preventative risk measures + impact) >>>>
     Risk assessment and risk estimates helps to understand the key factors associated with CVD. The concentration of specific races 
     vary by counties so by studying the underlying socioeconomic covariates of CVD mortality on the county-level, researchers and health 
     practitioners are thus able to curate the necessary risk preventative measures and allocate resources to the areas that need it the most. 
     Furthermore, the dose-response relationship of air pollutant concentrations in a region and its effects can be analyzed. By putting the focus on 
     smaller units, CVD-mortality rates will start to see a decline, nationally and globally.

# Methods

### Data

-   Combination of four data sets (will add citations later): CDC cardiovascular disease death rates per US counties, NASA particulate matter concentrations for the year 2015, US Census Data for 2015, and US Vaccination rate by county data

    -   Vaccination rates were not considered in the study, rather, the dataset was used for its geometry listing, which will be important for our GWR section.

-   We merged the four data sets together to analyze multiple variables against the CVM per 100,000 residents in each county. Variables included % of race present in county, PM2.5 concentrations, median income, and unemployment rates.

### Geographically Weighted Regression Model

-   Local Significance

    -   Coefficients have t-values and SE values, converted t-values into p-values with formula from code, extracted these p-values for each covariate and then plotted significance from p-values. The results of this should show which covariates have higher effects per county

    -   Per our (source), different regions of the United States should have different variables with greater significance relating to CVD rates.

        -   For example, in the midwest, food insecurity was found to be the most significant factor, while in the West it did not play much of a role compared to income, PM2.5, and access to healthcare.

```{r include=FALSE}
source("./Functions/gwmodelJohan.R")
source("./Functions/GWmodelRscript.R")
```

```{r}
gwr_results_sf%>%ggplot() +
  geom_sf(aes(fill = gwr_results_sf$y),
          color = scales::alpha("black",
                                alpha = 0.1
                                )) +
  scale_fill_gradientn(colours = terrain.colors(8),
                       #limits = c(19,530),
                       breaks = c(100,250,350)) +
  theme(text = element_text(size = 20), 
        legend.position = "bottom") + 
  labs(title = "GWR for particulate concentrations, 2015",
       fill = "Deaths from CVD per 100,000 people")
```

# Results

```{r}
gwr_results
```

Table Summary interpretation: The analysis compares two distinct statistical models to explore the relationships between socio-economic, demographic, and environmental variables and death rates. The first is a global regression model which, despite revealing that all predictors are highly statistically significant, does not take into account spatial correlation. Hence, while the model does suggest that our variables are indeed important, the global model may overlook local variations that are crucial in understanding the true nature of the data. 

On the other hand, the geographically weighted regression (GWR) model incorporates spatial variation, which is a critical factor given the context of the data. We can see how well the GWR model worked by looking at the R-squared value, which is .870, a significant improvement over the global model. This R-squared value, along with the use of localized spatial statistics, confirms the non-uniform relationship between the predictors and the response variable across different geographical areas. In summary, the GWR model, by accommodating the spatial component present in the data, provides a more realistic interpretation of how various factors influence death rates across different regions.

Significance plot:- 

The plots provided depict the local significance and magnitude of different parameters (covariates) from a geographically weighted regression (GWR) model, focusing on their relationship with death rates across the United States. The areas in red indicate regions where the covariates are statistically significant, and the color's intensity represents the effect's magnitude.

```{r}
#| layout-ncol: 2
#| layout-nrow: 2
#significance
local_t_values <- gwr_results_sf$prc_wht_TV
local_p_values <- 2 * pt(-abs(local_t_values), df = 2480.149) #df number cam from the Gw diagnostic


gwr_results_sf$prc_wht_p_values <- local_p_values


gwr_results_sf$prc_wht_signif_coef <- ifelse(gwr_results_sf$prc_wht_p_values < 0.05, 
                                             gwr_results_sf$prc_wht, 
                                             NA)  # Set to NA if not significant

library(ggplot2)
ggplot(gwr_results_sf) +
  geom_sf(aes(fill = prc_wht_signif_coef), color = alpha("black",0.35), size = 0.1) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                      name = "Magnitude", limits = NULL) +  
  labs(title = "Local Significance and Magnitude of '% White' Parameter",
       subtitle = "Geographically Weighted Regression (GWR)",
       caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
  theme_minimal() +
  theme(text = element_text(size = 12), legend.position = "right")

#significance
local_t_values_2 <- gwr_results_sf$prc_frc_TV
local_p_values_2 <- 2 * pt(-abs(local_t_values_2), df = 2480.149) #df number cam from the Gw diagnostic


gwr_results_sf$prc_af_p_values <- local_p_values_2


gwr_results_sf$prc_af_signif_coef <- ifelse(gwr_results_sf$prc_af_p_values < 0.05, 
                                             gwr_results_sf$prc_frc, 
                                             NA)  # Set to NA if not significant

library(ggplot2)
ggplot(gwr_results_sf) +
  geom_sf(aes(fill = prc_af_signif_coef), color = alpha("black",0.35), size = 0.1) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                      name = "Magnitude", limits = NULL) +  
  labs(title = "Local Significance and Magnitude of '% African American' Parameter",
       subtitle = "Geographically Weighted Regression (GWR)",
       caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
  theme_minimal() +
  theme(text = element_text(size = 12), legend.position = "right")

#significance
local_t_values_3 <- gwr_results_sf$prc_hsp_TV
local_p_values_3 <- 2 * pt(-abs(local_t_values_3), df = 2480.149) #df number cam from the Gw diagnostic



gwr_results_sf$prc_hsp_p_values <- local_p_values_3


gwr_results_sf$prc_hsp_signif_coef <- ifelse(gwr_results_sf$prc_hsp_p_values < 0.05, 
                                             gwr_results_sf$prc_hsp, 
                                             NA)  # Set to NA if not significant

library(ggplot2)
ggplot(gwr_results_sf) +
  geom_sf(aes(fill = prc_hsp_signif_coef), color = alpha("black",0.35), size = 0.1) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                      name = "Magnitude", limits = NULL) +  
  labs(title = "Local Significance and Magnitude of '% Hispanic' Parameter",
       subtitle = "Geographically Weighted Regression (GWR)",
       caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
  theme_minimal() +
  theme(text = element_text(size = 12), legend.position = "right")

#significance
local_t_values_4 <- gwr_results_sf$perc_sn_TV
local_p_values_4 <- 2 * pt(-abs(local_t_values_4), df = 2480.149) #df number cam from the Gw diagnostic


gwr_results_sf$prc_sn_p_values <- local_p_values_4


gwr_results_sf$prc_sn_signif_coef <- ifelse(gwr_results_sf$prc_sn_p_values < 0.05, 
                                             gwr_results_sf$perc_sn, 
                                             NA)  # Set to NA if not significant

library(ggplot2)
ggplot(gwr_results_sf) +
  geom_sf(aes(fill = prc_sn_signif_coef), color = alpha("black",0.35), size = 0.1) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                      name = "Magnitude", limits = NULL) +  
  labs(title = "Local Significance and Magnitude of '% Asian' Parameter",
       subtitle = "Geographically Weighted Regression (GWR)",
       caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
  theme_minimal() +
  theme(text = element_text(size = 12), legend.position = "right")
```

-   Demographic Impact: The percentage of white and Hispanic populations shows significant regional variations in association with death rates. Higher proportions of white populations correlate with lower death rates in central areas, whereas higher percentages of Hispanic populations are linked to lower death rates in the West and Southwest. Conversely, higher percentages of African American populations are associated with higher death rates in certain Midwestern and Southeastern regions.

```{r}
#significance
local_t_values_5 <- gwr_results_sf$p2_5_20_TV
local_p_values_5 <- 2 * pt(-abs(local_t_values_5), df = 2480.149) #df number cam from the Gw diagnostic



gwr_results_sf$prc_p2_p_values <- local_p_values_5


gwr_results_sf$prc_p2_signif_coef <- ifelse(gwr_results_sf$prc_p2_p_values < 0.05, 
                                             gwr_results_sf$p2_5_20, 
                                             NA)  # Set to NA if not significant

library(ggplot2)
ggplot(gwr_results_sf) +
  geom_sf(aes(fill = prc_p2_signif_coef), color = "black", size = 0.1) +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                      name = "Coefficient Magnitude", limits = NULL) +  
  labs(title = "Local Significance and Magnitude of PM2.5 Parameter",
       subtitle = "Geographically Weighted Regression (GWR)",
       caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
  theme_minimal() +
  theme(text = element_text(size = 12), legend.position = "right")
```

-   Environmental Influence: Air quality, indicated by PM2.5 levels, demonstrates a significant positive relationship with death rates, particularly east of the Rockies, highlighting environmental health as a major concern.

    ```{r}
    #significance
    local_t_values_6 <- gwr_results_sf$estimat_TV
    local_p_values_6 <- 2 * pt(-abs(local_t_values_6), df = 2480.149) #df number cam from the Gw diagnostic


    gwr_results_sf$prc_est_p_values <- local_p_values_6


    gwr_results_sf$prc_est_signif_coef <- ifelse(gwr_results_sf$prc_est_p_values < 0.05, 
                                                 gwr_results_sf$estimat, 
                                                 NA)  # Set to NA if not significant

    library(ggplot2)
    ggplot(gwr_results_sf) +
      geom_sf(aes(fill = prc_est_signif_coef), color = "black", size = 0.1) +
      scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                          name = "Coefficient Magnitude", limits = NULL) +  
      labs(title = "Local Significance of Median Income Parameter",
           subtitle = "Geographically Weighted Regression (GWR)",
           caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
      theme_minimal() +
      theme(text = element_text(size = 12), legend.position = "right")

    #significance
    local_t_values_7 <- gwr_results_sf$U__2015
    local_p_values_7 <- 2 * pt(-abs(local_t_values_7), df = 2480.149) #df number cam from the Gw diagnostic


    gwr_results_sf$prc_U_2015_p_values <- local_p_values_7


    gwr_results_sf$prc_U_2015_signif_coef <- ifelse(gwr_results_sf$prc_U_2015_p_values < 0.05, 
                                                 gwr_results_sf$U__2015, 
                                                 NA)  # Set to NA if not significant

    library(ggplot2)
    ggplot(gwr_results_sf) +
      geom_sf(aes(fill = prc_U_2015_signif_coef), color = "black", size = 0.1) +
      scale_fill_gradient2(low = "blue", mid = "white", high = "red", na.value = "white", 
                          name = "Coefficient Magnitude", limits = NULL) +  
      labs(title = "Local Significance of Unemployment Parameter",
           subtitle = "Geographically Weighted Regression (GWR)",
           caption = "Blue indicates lower magnitude of effect and Red indicates larger magnitude of effect;\nwhite indicates no significant effect") +
      theme_minimal() +
      theme(text = element_text(size = 12), legend.position = "right")
    ```

<!-- -->

-   Socio-economic Correlation: Median income levels across many regions show a consistent negative association with death rates, suggesting that higher income areas generally experience fewer deaths.

# Discussion

These maps reveal that the relationships between race, socio-economic factors, environmental quality, and death rates are complex and highly localized. The significance and strength of these relationships vary considerably across different parts of the United States. For example, 

-   Socio-economic factors like income show widespread significance, implying a consistent relationship with health outcomes across various locations.

<!-- -->

-   Race impacts are significant in certain areas, which may reflect underlying health disparities, access to care, or other social determinants of health.

<!-- -->

-   Air quality has a broad impact, suggesting environmental health concerns that might require region-specific policies. 

{{< pagebreak >}}

# References {.unnumbered}

::: {#refs}
:::

[@article-journal]
